// =======================================================================================
// Wovencore by Wovencode (c)
// =======================================================================================
using System;
using System.Collections;
using UnityEngine;
using UnityEngine.Events;
using UnityEngine.UI;
using woco.core;

namespace woco.core
{
	
	// ===================================================================================
	// _BaseWidget
	// ===================================================================================
	public abstract partial class _BaseWindow : _BaseUI
	{
	
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		// PROPERTIES
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		
		public Animator animator;
		public BackgroundWindow backgroundWindow;
    	public string showTriggerName 	= "show";
    	public string closeTriggerName 	= "close";
    
		public UnityEvent onShow;
		public UnityEvent onHide;
		public UnityEvent onDraw;
		
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		// MONO
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		
		// -------------------------------------------------------------------------------
		// OnEnable
		// -------------------------------------------------------------------------------
		protected void OnEnable() {
			Show();
		}
		
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		// PUBLIC FUNCTIONS
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		
		// -------------------------------------------------------------------------------
		// Show
		// -------------------------------------------------------------------------------
		public virtual void Show()
		{
			animator.SetTrigger(showTriggerName);
        	backgroundWindow.FadeIn();
        
			OnDraw();
			OnShow();
		}
		
		// -------------------------------------------------------------------------------
		// Hide
		// -------------------------------------------------------------------------------
		public virtual void Hide()
		{
			animator.SetTrigger(closeTriggerName);
			backgroundWindow.FadeOut();
			StartCoroutine(nameof(HideWindow));
		}
		
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		// PROTECTED FUNCTIONS
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

		// -------------------------------------------------------------------------------
		// DeactivateWindow
		// -------------------------------------------------------------------------------		
		protected IEnumerator HideWindow()
    	{
        	yield return new WaitForSeconds(animator.GetCurrentAnimatorStateInfo(0).length);
        	OnHide();
    	}
		
		// -------------------------------------------------------------------------------
		// SlowUpdate
		// -------------------------------------------------------------------------------
		protected override void SlowUpdate(){}

		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		// EVENTS
		// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		
		// -------------------------------------------------------------------------------
 		// OnShow
		// -------------------------------------------------------------------------------
        public void OnShow() {
        
        	/*
        		animate window
        		fade background
        	*/
        	
        	gameObject.SetActive(true);
        	
        }
		
		// -------------------------------------------------------------------------------
 		// OnHide
 		// -------------------------------------------------------------------------------
        public void OnHide() {
        
        	/*
        		animate window
        		fade background
        	*/
        	
        	gameObject.SetActive(false);
        
        }
        
		// -------------------------------------------------------------------------------
		// OnDraw
		// -------------------------------------------------------------------------------
		public abstract void OnDraw();
		
		// -------------------------------------------------------------------------------

	}
	
	// ===================================================================================
	
}
